<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HotSpot</title>
</head>
<body>

    <p class="status-text">Loading...</p>
    
    <script>
        function isValidUrl(url) {
            try {
                new URL(url);
                return true;
            } catch (e) {
                return false;
            }
        }
        window.onload = () => {
            const currUrlQuery = window.location.search
            
            if(currUrlQuery.trim() == "") {
                document.querySelector(".status-text").textContent = "No data found in the url"
                return
            }

            const appSchemaUrl = `hotspotlive://${currUrlQuery.includes("group") ? "open-group" : "open-event"}${currUrlQuery}`
            const appStoreUrl = "https://apps.apple.com/us/app/hotspot/id6444371402"
            console.log(currUrlQuery)
            
            const currentTime = Date.now()
            fetch(appSchemaUrl, {method: "GET"})
                .then(resp => {
                    console.log(resp.status == 404);
                    if(resp.status == 404) {
                        window.location.href = appStoreUrl
                        
                    } else {
                        window.location.href = appSchemaUrl
                        
                    }
                })
                .catch(err => {
                    console.log(err)
                    window.location.href = appStoreUrl

                })
            

        }
        
        
    </script>
</body>
</html>
